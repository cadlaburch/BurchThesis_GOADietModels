"Other Prey", "Fishes", "Fishes", "Other Prey",
"Other Prey", "Other Prey", "Fishes", "Other Prey",
"Fishes", "Other Prey", "Other Prey", "Fishes",
"Fishes", "Fishes", "Fishes", "Fishes",
"Fishes", "Fishes", "Other Prey", "Other Prey",
"Fishes", "Fishes", "Fishes", "Fishes",
"Other Prey", "Fishes", "Fishes", "Fishes",
"Fishes", "Fishes")
PreyCategories <- data.frame(Prey_Name, BuckleyGroup)
sc_data <- left_join(raw_stomach_contents,PreyCategories,by="Prey_Name")
sc_data <- sc_data %>%
mutate(Len_bin = cut(Pred_len, breaks = c(0, 20, 30, 40, 50, 60, 275)))
#Walleye Pollock
Poll_PW <- sc_data %>%
filter(Pred_nodc == 8791030701) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
ggplot(Poll_PW, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity")+
labs(title = "Walleye Pollock All Years")
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#bcf60c', '#3cb44b',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000')
ggplot(Poll_PW, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years")
WalleyePollockAllYears <- ggplot(Poll_PW, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years")
ggsave(WalleyePollockAllYears.jpg, plot = WalleyePollockAllYears,
path = here("output"), device = "jpg")
ggsave("WalleyePollockAllYears.jpg", plot = WalleyePollockAllYears,
path = here("output"), device = "jpg")
WalleyePollockAllYears <- ggplot(Poll_PW, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight")
WalleyePollockAllYears
WalleyePollockAllYears <- ggplot(Poll_PW, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length")
ggsave("WalleyePollockAllYears.jpg", plot = WalleyePollockAllYears,
path = here("output"), device = "jpg")
#Walleye Pollock
Poll_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030701) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Walley Pollock %W by year
Poll_PW_BY <- sc_data %>%
filter(Pred_nodc == 8791030701) %>%
group_by(Year, Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length")
WalleyPollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length")
ggsave("WalleyePollockByYear.jpg", plot = WalleyePollockByYear,
path = here("output"), device = "jpg")
WalleyePollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length")
ggsave("WalleyePollockByYear.jpg", plot = WalleyePollockByYear,
path = here("output"), device = "jpg")
WalleyePollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length") +
scale_x_discrete(limits = c("<20", "30", "40", "50", ">60"))
WalleyePollockByYear
WalleyePollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length") +
scale_x_discrete(limits = c("<20", "30", "40", "50", "60", ">60"))
WalleyePollockByYear
WalleyePollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length")
WalleyePollockByYear
WalleyePollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock By Year", y = "percent weight",
x = "predator length")
ggsave("WalleyePollockByYear.jpg", plot = WalleyePollockByYear,
path = here("output"), device = "jpg")
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#a9a9a9', '#3cb44b',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000')
WalleyePollockAllYears <- ggplot(Poll_PW_AY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock All Years", y = "percent weight",
x = "predator length")
WalleyePollockAllYears
ggsave("WalleyePollockAllYears.jpg", plot = WalleyePollockAllYears,
path = here("output"), device = "jpg")
#Walleye Pollock %W by year
Poll_PW_BY <- sc_data %>%
filter(Pred_nodc == 8791030701) %>%
group_by(Year, Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
WalleyePollockByYear <- ggplot(Poll_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock By Year", y = "percent weight",
x = "predator length")
ggsave("WalleyePollockByYear.jpg", plot = WalleyePollockByYear,
path = here("output"), device = "jpg")
#######
#Pacific Cod %W for all years
PC_PW_AY <- sc_data %>%
filter(Pred_name == "Gadus macrocephalus") %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
View(PC_PW_AY)
PC_PW_AY <- sc_data %>%
filter(Pred_name == "Gadus macrocephalus")
View(PC_PW_AY)
#######
#Pacific Cod %W for all years
PC_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#######
#Pacific Cod %W for all years
Cod_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
ggsave("CodAllYears.jpg", plot = CodAllYears,
path = here("output"), device = "jpg")
#Cod %W by year
Cod_PW_BY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Year, Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
CodByYear <- ggplot(Cod_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod By Year", y = "percent weight",
x = "predator length")
ggsave("CodByYear.jpg", plot = WalleyePollockByYear,
path = here("output"), device = "jpg")
ggsave("CodByYear.jpg", plot = CodByYear,
path = here("output"), device = "jpg")
Sable_PW_AY <- sc_data %>%
filter(Pred_name == "Anoplopoma fimbria")
View(Sable_PW_AY)
#######
#Sablefish %W for all years
Sable_PW_AY <- sc_data %>%
filter(Pred_nodc == 8827020101) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
SableAllYears <- ggplot(Sable_PW_AY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Sablefish All Years", y = "percent weight",
x = "predator length")
SableAllYears
#Sablefish %W by year
Sable_PW_BY <- sc_data %>%
filter(Pred_nodc == 8827020101) %>%
group_by(Year, Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
SableByYear <- ggplot(Sable_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Sablefish By Year", y = "percent weight",
x = "predator length")
ggsave("SableByYear.jpg", plot = SableByYear,
path = here("output"), device = "jpg")
ggsave("SableAllYears.jpg", plot = SableAllYears,
path = here("output"), device = "jpg")
Arrow_PW_AY <- sc_data %>%
filter(Pred_name == "Atheresthes stomias")
View(Arrow_PW_AY)
#######
#Arrowtooth Flounder %W for all years
Arrow_PW_AY <- sc_data %>%
filter(Pred_nodc == 8857040102) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
ArrowAllYears <- ggplot(Arrow_PW_AY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "A. Flounder All Years", y = "percent weight",
x = "predator length")
ggsave("ArrowAllYears.jpg", plot = ArrowAllYears,
path = here("output"), device = "jpg")
ArrowAllYears
#Arrow %W by year
Arrow_PW_BY <- sc_data %>%
filter(Pred_nodc == 8857040102) %>%
group_by(Year, Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
ArrowByYear <- ggplot(Arrow_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "A. Flounder By Year", y = "percent weight",
x = "predator length")
ggsave("ArrowByYear.jpg", plot = ArrowByYear,
path = here("output"), device = "jpg")
Hal_PW_AY <- sc_data %>%
filter(Pred_name == "Hippoglossus stenolepis")
View(Hal_PW_AY)
#######
#Halibut %W for all years
Hal_PW_AY <- sc_data %>%
filter(Pred_nodc == 8857041901) %>%
group_by(Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
HalAllYears <- ggplot(Hal_PW_AY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut All Years", y = "percent weight",
x = "predator length")
ggsave("HalAllYears.jpg", plot = HalAllYears,
path = here("output"), device = "jpg")
#Halibut %W by year
Hal_PW_BY <- sc_data %>%
filter(Pred_nodc == 8857041901) %>%
group_by(Year, Len_bin, BuckleyGroup) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
HalByYear <- ggplot(Hal_PW_BY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut By Year", y = "percent weight",
x = "predator length")
ggsave("HalByYear.jpg", plot = HalByYear,
path = here("output"), device = "jpg")
#Walleye Pollock %W by year for each size class
ggplot(Poll_PW_BY, aes(x = Year, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Len_bin) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock By Year", y = "percent weight",
x = "predator length")
#Walleye Pollock %W by year for each size class
WalleyeYearClass <- ggplot(Poll_PW_BY, aes(x = Year, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
facet_wrap(~Len_bin) +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock By Year", y = "percent weight",
x = "predator length")
ggsave("WalleyeYearClass.jpg", plot = WalleyeYearClass,
path = here("output"), device = "jpg")
Yang_Cod <- c("Empty", "Shrimp", "Shrimp", "Euphausiid",
"Other Prey", "Other Crab", "Other Crab", "Other Prey",
"Other Fish", "Other Prey", "Other Prey", "Tanner Crab",
"Other Prey", "Shrimp", "Shrimp", "Other Fish",
"Other Prey", "Other Fish", "Polychaeta", "Other Fish",
"Walleye pollock", "Other Prey", "Shrimp", "Other Prey",
"Flatfish", "Other Fish", "Other Fish", "Other Fish",
"Other Fish", "Flatfish", "Other Crabs", "Other Prey",
"Other Prey", "Other Prey", "Other Crabs", "Other Fish",
"Other Fish", "Other Prey", "Other Prey", "Other Prey",
"Other Prey", "Other Crab", "Other Fish", "Other Crab",
"Other Prey", "Other Prey", "Other Prey", "Other Fish",
"Other Prey", "Other Prey", "Other Crab", "Other Prey",
"Other Prey", "Other Crab", "Shrimp", "Other Fish",
"Other Fish", "Other Crab", "Other Prey", "Other Fish",
"Other Prey", "Other Fish", "Other Fish", "Other Prey",
"Other Prey", "Other Prey", "Other Fish", "Other Crab",
"Other Fish", "Other Prey", "Other Prey", "Flatfish",
"Macrouridae", "Flatfish", "Other Fish", "Other Fish",
"Other Fish", "Flatfish", "Misc", "Other Crab",
"Flatfish", "Other Fish", "Other Fish", "Other Fish",
"Other Crab", "Flatfish", "Flatfish", "Other Fish",
"Flatfish", "Flatfish")
PreyCategories <- data.frame(Prey_Name, BuckleyGroup, Yang_Cod)
sc_data <- left_join(raw_stomach_contents,PreyCategories,by="Prey_Name")
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = BuckleyGroup)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years (Yang)", y = "percent weight",
x = "predator length")
ggsave("CodAllYearsYang.jpg", plot = CodAllYears,
path = here("output"), device = "jpg")
CodByYear <- ggplot(Cod_PW_BY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod By Year (Yang)", y = "percent weight",
x = "predator length")
ggsave("CodByYearYang.jpg", plot = CodByYear,
path = here("output"), device = "jpg")
#Cod %W by year for each size class
CodYearClass <- ggplot(Cod_PW_BY, aes(x = Year, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
facet_wrap(~Len_bin) +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod By Year (Yang)", y = "percent weight",
x = "predator length")
ggsave("CodYearClassYang.jpg", plot = CodYearClass,
path = here("output"), device = "jpg")
#Pacific Cod %W for all years
Cod_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, Yang_Cod) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
sc_data <- left_join(raw_stomach_contents,PreyCategories,by="Prey_Name")
#Pacific Cod %W for all years
Cod_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, Yang_Cod) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
PreyCategories <- data.frame(Prey_Name, BuckleyGroup, Yang_Cod)
sc_data <- left_join(raw_stomach_contents,PreyCategories,by="Prey_Name")
#Pacific Cod %W for all years
Cod_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, Yang_Cod) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
raw_stomach_contents %>%
filter(Pred_nodc == 8791030401) %>%
quantile(Pred_len)
raw_stomach_contents %>%
filter(Pred_nodc == 8791030401) %>%
quantile(Pred_len, na.rm = T)
cod <-raw_stomach_contents %>%
filter(Pred_nodc == 8791030401)
quantile(cod$Pred_len)
sc_data <- sc_data %>%
mutate(Len_bin = cut(Pred_len, breaks = c(0, 10, 20, 30, 40, 50, 60, 105)))
#Pacific Cod %W for all years
Cod_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, Yang_Cod) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#a9a9a9', '#3cb44b',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000', '#aaffc3', '#e6beff')
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#a9a9a9', '#3cb44b', '#008080',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000', '#aaffc3', '#e6beff')
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
Yang_Cod <- c("Other Prey", "Shrimp", "Shrimp", "Euphausiid",
"Other Prey", "Other Crab", "Other Crab", "Other Prey",
"Other Fish", "Other Prey", "Other Prey", "Tanner Crab",
"Other Prey", "Shrimp", "Shrimp", "Other Fish",
"Other Prey", "Other Fish", "Polychaeta", "Other Fish",
"Walleye pollock", "Other Prey", "Shrimp", "Other Prey",
"Flatfish", "Other Fish", "Other Fish", "Other Fish",
"Other Fish", "Flatfish", "Other Crab", "Other Prey",
"Other Prey", "Other Prey", "Other Crabs", "Other Fish",
"Other Fish", "Other Prey", "Other Prey", "Other Prey",
"Other Prey", "Other Crab", "Other Fish", "Other Crab",
"Other Prey", "Other Prey", "Other Prey", "Other Fish",
"Other Prey", "Other Prey", "Other Crab", "Other Prey",
"Other Prey", "Other Crab", "Shrimp", "Other Fish",
"Other Fish", "Other Crab", "Other Prey", "Other Fish",
"Other Prey", "Other Fish", "Other Fish", "Other Prey",
"Other Prey", "Other Prey", "Other Fish", "Other Crab",
"Other Fish", "Other Prey", "Other Prey", "Flatfish",
"Other Fish", "Flatfish", "Other Fish", "Other Fish",
"Other Fish", "Flatfish", "Misc", "Other Crab",
"Flatfish", "Other Fish", "Other Fish", "Other Fish",
"Other Crab", "Flatfish", "Flatfish", "Other Fish",
"Flatfish", "Flatfish")
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#a9a9a9', '#3cb44b',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000')
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
Yang_Cod <- c("Other Prey", "Shrimp", "Shrimp", "Euphausiid",
"Other Prey", "Other Crab", "Other Crab", "Other Prey",
"Other Fish", "Other Prey", "Other Prey", "Tanner Crab",
"Other Prey", "Shrimp", "Shrimp", "Other Fish",
"Other Prey", "Other Fish", "Polychaeta", "Other Fish",
"Walleye pollock", "Other Prey", "Shrimp", "Other Prey",
"Flatfish", "Other Fish", "Other Fish", "Other Fish",
"Other Fish", "Flatfish", "Other Crab", "Other Prey",
"Other Prey", "Other Prey", "Other Crabs", "Other Fish",
"Other Fish", "Other Prey", "Other Prey", "Other Prey",
"Other Prey", "Other Crab", "Other Fish", "Other Crab",
"Other Prey", "Other Prey", "Other Prey", "Other Fish",
"Other Prey", "Other Prey", "Other Crab", "Other Prey",
"Other Prey", "Other Crab", "Shrimp", "Other Fish",
"Other Fish", "Other Crab", "Other Prey", "Other Fish",
"Other Prey", "Other Fish", "Other Fish", "Other Prey",
"Other Prey", "Other Prey", "Other Fish", "Other Crab",
"Other Fish", "Other Prey", "Other Prey", "Flatfish",
"Other Fish", "Flatfish", "Other Fish", "Other Fish",
"Other Fish", "Flatfish", "Misc", "Other Crab",
"Flatfish", "Other Fish", "Other Fish", "Other Fish",
"Other Crab", "Flatfish", "Flatfish", "Other Fish",
"Flatfish", "Flatfish")
PreyCategories <- data.frame(Prey_Name, BuckleyGroup, Yang_Cod)
sc_data <- left_join(raw_stomach_contents,PreyCategories,by="Prey_Name")
cod <-raw_stomach_contents %>%
filter(Pred_nodc == 8791030401)
sc_data <- sc_data %>%
mutate(Len_bin = cut(Pred_len, breaks = c(0, 10, 20, 30, 40, 50, 60, 105)))
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#a9a9a9', '#3cb44b',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000')
#Pacific Cod %W for all years
Cod_PW_AY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Len_bin, Yang_Cod) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
colorlist<-c('#e6194b', '#f58231', '#ffe119', '#a9a9a9', '#3cb44b',
'#46f0f0', '#4363d8', '#911eb4', '#f032e6', '#800000', '#e6beff')
CodAllYears <- ggplot(Cod_PW_AY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod All Years", y = "percent weight",
x = "predator length")
CodAllYears
ggsave("CodAllYearsYang.jpg", plot = CodAllYears,
path = here("output"), device = "jpg")
#Cod %W by year
Cod_PW_BY <- sc_data %>%
filter(Pred_nodc == 8791030401) %>%
group_by(Year, Len_bin, Yang_Cod) %>%
summarise(TotalWt = sum(Prey_twt))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
CodByYear <- ggplot(Cod_PW_BY, aes(x = Len_bin, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
facet_wrap(~Year) +
scale_fill_manual(values = colorlist) +
labs(title = "P. Cod By Year (Yang)", y = "percent weight",
x = "predator length")
ggsave("CodByYearYang.jpg", plot = CodByYear,
path = here("output"), device = "jpg")
#Cod %W by year for each size class
CodYearClass <- ggplot(Poll_PW_BY, aes(x = Year, y = PW, fill = Yang_Cod)) +
geom_bar(stat = "identity") +
facet_wrap(~Len_bin) +
scale_fill_manual(values = colorlist) +
labs(title = "Cod By Year (Yang)", y = "percent weight",
x = "predator length")
ggsave("CodYearClassYang.jpg", plot = CodYearClass,
path = here("output"), device = "jpg")
