mutate(walleye_p = ifelse(stock_groupings == "arthropoda", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 350)))
range(Halibut_art$walleyestomachs)
Halibut_art_plot <- ggplot(Halibut_art, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(show.legend = F, aes(size = samplesize)) +
scale_y_continuous(limits = c(0,0.75)) +
scale_color_manual(values = colorlist2) +
labs(title = "Pacific Halibut") +
theme_void()
#Arrowtooth consuming pollock
Arrow_art <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", ) %>%
mutate(walleye_p = ifelse(stock_groupings == "arthropoda", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 530)))
range(Arrow_art$walleyestomachs)
Arrow_art_plot <- ggplot(Arrow_art, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(show.legend = F, aes(size = samplesize)) +
scale_y_continuous(limits = c(0,0.75)) +
scale_color_manual(values = colorlist2) +
labs(title = "Arrowtooth Flounder") +
theme_void()
#Pollock eating pollock
Poll_art <- stomach_contents_2021 %>%
filter(Pred_common == "Walleye pollock") %>%
mutate(walleye_p = ifelse(stock_groupings == "arthropoda", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 650)))
range(Poll_art$walleyestomachs)
Poll_art_plot <- ggplot(Poll_art, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(show.legend = F, aes(size = samplesize)) +
scale_y_continuous(limits = c(0,0.75)) +
scale_color_manual(values = colorlist2) +
labs(title = "Walleye Pollock") +
theme_void()
#Cod eating pollock
Cod_art <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod") %>%
mutate(walleye_p = ifelse(stock_groupings == "arthropoda", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 560)))
range(Cod_art$walleyestomachs)
Cod_art_plot <- ggplot(Cod_art, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(aes(size = samplesize), show.legend = F) +
scale_y_continuous(limits = c(0,0.75)) +
theme_classic() +
scale_color_manual(values = colorlist2) +
labs(y = "relative occurence (0-0.75)", title = "Pacific Cod") +
theme(axis.text.y=element_blank(),
axis.line = element_blank(),
axis.ticks=element_blank())
#geom_text(aes( x = Year, y = walleye_RO+0.05, label = walleyestomachs)) +
#piece together
artconsumption <- Arrow_art_plot / Halibut_art_plot / Poll_art_plot / Cod_art_plot
artconsumption
#--------------------
#Consumption of Osmerids (smelts)
#Halibut
Halibut_osm <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific halibut") %>%
mutate(walleye_p = ifelse(Prey_Name_Clean == "Osmeridae", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 120)))
Halibut_osm_plot <- ggplot(Halibut_osm, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(show.legend = F, aes(size = samplesize)) +
scale_y_continuous(limits = c(0,0.25)) +
scale_color_manual(values = colorlist2) +
labs(title = "Pacific Halibut") +
theme_void()
#Arrowtooth consuming pollock
Arrow_osm <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", ) %>%
mutate(walleye_p = ifelse(Prey_Name_Clean == "Osmeridae", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 530)))
Arrow_osm_plot <- ggplot(Arrow_osm, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(show.legend = F, aes(size = samplesize)) +
scale_y_continuous(limits = c(0,0.25)) +
scale_color_manual(values = colorlist2) +
labs(title = "Arrowtooth Flounder") +
theme_void()
#Pollock eating pollock
Poll_osm <- stomach_contents_2021 %>%
filter(Pred_common == "Walleye pollock") %>%
mutate(walleye_p = ifelse(Prey_Name_Clean == "Osmeridae", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 40)))
Poll_osm_plot <- ggplot(Poll_osm, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(show.legend = F, aes(size = samplesize)) +
scale_y_continuous(limits = c(0,0.25)) +
scale_color_manual(values = colorlist2) +
labs(title = "Walleye Pollock") +
theme_void()
#Cod eating pollock
Cod_osm <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod") %>%
mutate(walleye_p = ifelse(Prey_Name_Clean == "Osmeridae", 1, 2)) %>%
group_by(Year) %>%
mutate(totalstomachs = length(unique(uniqueID))) %>%
ungroup() %>%
filter(walleye_p == 1) %>%
group_by(Year, Len_bin_PC_broad) %>%
mutate(walleyestomachs = length(unique(uniqueID))) %>%
select(Year, walleyestomachs, totalstomachs, PRED_LEN, uniqueID, Len_bin_PC_broad) %>%
mutate(walleye_RO = walleyestomachs/totalstomachs,
samplesize = cut(walleyestomachs, breaks = c(0, 10, 30, 80)))
Cod_osm_plot <- ggplot(Cod_osm, aes(x = Year, y = walleye_RO, color = Len_bin_PC_broad)) +
geom_line(show.legend = F) +
geom_point(aes(size = samplesize), show.legend = F) +
scale_y_continuous(limits = c(0,0.25)) +
theme_classic() +
scale_color_manual(values = colorlist2) +
labs(y = "relative occurance", title = "Pacific Cod") +
theme(axis.text.y=element_blank(),
axis.line = element_blank(),
axis.ticks=element_blank())
#geom_text(aes( x = Year, y = walleye_RO+0.05, label = walleyestomachs)) +
#piece together
osmeridconsumption <- Arrow_osm_plot / Halibut_osm_plot / Poll_osm_plot / Cod_osm_plot
ggsave("osmeridconsumption.pdf", plot = osmeridconsumption,
path = here("output/Figure 2"), device = "pdf",
height = 11, width = 6)
osmeridconsumption
#Combine
Fig1 <- (Arrow_Stock + Halibut_Stock) / (Pollock_Stock + Cod_Stock)
Fig1
ggsave("Fig1.pdf", plot = Fig1,
path = here("output/Figure 1"), device = "pdf", height = 8, width = 12.5)
Cod_len$stock_groupings <- factor(Cod_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
legend_plot
#legend figure
legend <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod", stock_arrowtooth != "empty") %>%
group_by(Len_bin_CD) %>%
mutate(n = length(unique(uniqueID))) %>%
ungroup() %>%
group_by(Len_bin_CD, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT), n = unique(n))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
View(legend)
legend$stock_groupings <- factor(legend$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Arrow_Stock
Halibut_Stock
Halibut_len$stock_groupings <- factor(Halibut_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_HB, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_HB, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Pacific Halibut", y = "",
x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", "80-90",
"90-100", "100-110", "110-120", ">120"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_HB, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = T) + #geom_text(aes(x = Len_bin_HB, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Pacific Halibut", y = "",
x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", "80-90",
"90-100", "100-110", "110-120", ">120"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
Halibut_Stock
Halibut_Stock
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_HB, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_HB, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Pacific Halibut", y = "",
x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", "80-90",
"90-100", "100-110", "110-120", ">120"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
Halibut_Stock
Pollock_len$stock_groupings <- factor(Pollock_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_AF, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_AF, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock", y = "Percent weight",
x = "Predator length (cm)") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", ">70"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
axis.title = element_text(size = 18),
plot.title = element_text(size = 20))
Pollock_Stock
Cod_len$stock_groupings <- factor(Cod_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Cod_Stock <- ggplot(Cod_len, aes(x = Len_bin_CD, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_CD, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Pacific Cod", y = "", x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", ">80"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic() +
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
Cod_Stock
#Combine
Fig1 <- (Arrow_Stock + Halibut_Stock) / (Pollock_Stock + Cod_Stock)
Fig1
colorlist<-c('#8A0000', "#C80000", '#e34a33', '#fc8d59', '#fdcc8a', '#fef0d9', 'white',
'#f1eef6', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#034e7b')
#legend figure
legend <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod", stock_arrowtooth != "empty") %>%
group_by(Len_bin_CD) %>%
mutate(n = length(unique(uniqueID))) %>%
ungroup() %>%
group_by(Len_bin_CD, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT), n = unique(n))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
legend$stock_groupings <- factor(legend$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
legend_plot <- ggplot(legend, aes(x = Len_bin_CD, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = T) +
scale_fill_manual(values = colorlist)
legend_plot
Arrowtooth_len$stock_groupings <- factor(Arrowtooth_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_AF, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_AF, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Flounder", y = "",
x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", ">70"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
Halibut_len$stock_groupings <- factor(Halibut_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_HB, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_HB, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Pacific Halibut", y = "",
x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", "80-90",
"90-100", "100-110", "110-120", ">120"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
Pollock_len$stock_groupings <- factor(Pollock_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_AF, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_AF, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Walleye Pollock", y = "Percent weight",
x = "Predator length (cm)") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", ">70"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic()+
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
axis.title = element_text(size = 18),
plot.title = element_text(size = 20))
Cod_len$stock_groupings <- factor(Cod_len$stock_groupings,
levels = c("Arthropoda", "commercial crab", "copepod", "benthic invertebrate", "euphausiids",
"zooplankton", "other","cod", "flatfish",
"walleye pollock","salmon","rockfish", "forage fish", "other fish"))
Cod_Stock <- ggplot(Cod_len, aes(x = Len_bin_CD, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity", show.legend = F) + #geom_text(aes(x = Len_bin_CD, y = 103, label = n), color = '#b30000') +
scale_fill_manual(values = colorlist) +
labs(title = "Pacific Cod", y = "", x = "") +
scale_x_discrete(labels = c("<20", "20-30", "30-40", "40-50", "50-60", "60-70", "70-80", ">80"),
expand = c(0, 0),
guide = guide_axis(angle = 30)) +
scale_y_continuous(expand = c(0,2)) +
theme_classic() +
theme(text = element_text(family = "Times New Roman"),
plot.margin = margin(t = 0,  # Top margin
r = 0,  # Right margin
b = 0,  # Bottom margin
l = 0),
axis.text=element_text(size=15),
plot.title = element_text(size = 20))
#Combine
Fig1 <- (Arrow_Stock + Halibut_Stock) / (Pollock_Stock + Cod_Stock)
Fig1
View(PC)
#Sample sizes
pred_list <- list(WP, PH, PC, AF)
prey_list <- c("Euphausiacea", "Walleyepollock", "Ammodytidae", "Clupeoidei", "Osmerid")
output <- matrix(NA, nrow = 16 , ncol = 7)
output
output[1, 1] <- "Prey Name"
output
output[1:16, 1] <- "Euphausiacea"
output
as.numeric(WP$Len_bin)
AF <- data %>%
filter(Pred_common == "Arrowtooth flounder") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun() %>%
mutate(len_factor = as.factor(Len_bin))
AF <- data %>%
filter(Pred_common == "Arrowtooth flounder") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun()
View(AF)
AF <- data %>%
filter(Pred_common == "Arrowtooth flounder") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun() %>%
mutate(len_factor = as.factor(Len_bin))
AF <- data %>%
filter(Pred_common == "Arrowtooth flounder") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun() %>%
mutate(len_factor = as.numeric(Len_bin))
AF <- data %>%
filter(Pred_common == "Arrowtooth flounder") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun() %>%
mutate(len_num = as.numeric(Len_bin))
levels(AF$Len_bin) = c("<31", "31-50", "51-70", ">70")
WP <- data %>%
filter(Pred_common == "Walleye pollock") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 24, 39, 54, 1000))) %>%
haul_wide_fun() %>%
mutate(len_num = as.numeric(Len_bin))
levels(WP$Len_bin) = c("<25", "25-39", "40-54", ">54")
PH <- data %>%
filter(Pred_common == "Pacific halibut") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun() %>%
mutate(len_num = as.numeric(Len_bin))
levels(PH$Len_bin) = c("<31", "31-50", "51-70", ">70")
#Note: I couldn't find the sampling bins for PC so I made it the same as WP
PC <- data %>%
filter(Pred_common == "Pacific cod") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 24, 39, 54, 1000))) %>%
haul_wide_fun() %>%
mutate(len_num = as.numeric(Len_bin))
levels(PC$Len_bin) = c("<25", "25-39", "40-54", ">54")
AF <- data %>%
filter(Pred_common == "Arrowtooth flounder") %>%
mutate(Len_bin = cut(PRED_LEN, breaks = c(0, 31, 50, 70, 1000))) %>%
haul_wide_fun() %>%
mutate(len_num = as.numeric(Len_bin))
levels(AF$Len_bin) = c("<31", "31-50", "51-70", ">70")
#Full Model
Euph_AF_M <- gam(Osmerid ~ Year + s(RLONG, RLAT) + s(GEAR_DEPTH)+ s(GEAR_TEMP, k = 4) + Group_Pred_Len,
data = AF,
family = binomial(link = logit),
method = "GCV.Cp")
summary(Euph_AF_M)
#Plotting partial effects
Euph_AF_Plot1 <- visreg(Euph_AF_M, "Year",type = "conditional", scale = "response",
gg = TRUE, line=list(col="black"), xlab = "Year", ylab = "Partial Effect on Euphausiacea P/A") +
theme_classic() +
theme(axis.text.x = element_text(angle = -45))
Euph_AF_Plot2 <- visreg(Euph_AF_M, "GEAR_DEPTH",type = "conditional", scale = "response",
gg = TRUE, line=list(col="black"), xlab = "Gear_Depth", ylab = "") +
theme_classic()
Euph_AF_Plot3 <- visreg(Euph_AF_M, "GEAR_TEMP",type = "conditional", scale = "response",
gg = TRUE, line=list(col="black"), xlab = "Gear_temp", ylab = "") +
theme_classic()
Euph_AF_Plot4 <- visreg(Euph_AF_M, "Group_Pred_Len",type = "conditional", scale = "response",
gg = TRUE, line=list(col="black"), xlab = "Group_Pred_Len", ylab = "") +
theme_classic()
Euph_AF_MainP <- (Euph_AF_Plot1 + Euph_AF_Plot2) / (Euph_AF_Plot3 + Euph_AF_Plot4) +
plot_annotation(title = "Predator: Arrowtooth Flounder")
Euph_AF_MainP
Euph_AF_Plot3
gam.check(Euph_AF_M)
# Residudal diagnostics
par(mfrow=c(2,2))
gam.check(Euph_AF_M)
View(WP)
