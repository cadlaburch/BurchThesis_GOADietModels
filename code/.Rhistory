mutate(uniqueID = paste(HAULJOIN, PRED_NODC, PRED_SPECN,  sep = "_"),
Len_bin_20 = cut(PRED_LEN, breaks = c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200,
220, 240, 260, 280)),
Len_bin_10 = cut(PRED_LEN, breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110,
120, 130, 140, 150, 160, 170, 180, 190, 200, 210,
220, 230, 240, 250, 260, 270, 280)))
#Creating summary figures which includes predator length
#recalculating PW including length bins
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Halibut_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific halibut", stock_arrowtooth != "empty") %>%
group_by(Len_bin_20, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_20, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
Halibut_Stock
ggsave("Arrow_stock_10.jpg", plot = Arrow_Stock,
path = here("output"), device = "jpg")
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Halibut_Stock
Halibut_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific halibut", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Halibut_Stock
ggsave("Arrow_stock_10.jpg", plot = Arrow_Stock,
path = here("output"), device = "jpg")
ggsave("Halibut_stock_10.jpg", plot = Halibut_Stock,
path = here("output"), device = "jpg")
Pollock_len <- stomach_contents_2021 %>%
filter(Pred_common == "Walleye pollock", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Pollock_Stock
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Pollock Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Pollock_Stock
Cod_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Cod_Stock <- ggplot(Cod_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Cod Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Cod_Stock
ggsave("Pollock_stock_10.jpg", plot = Pollock_Stock,
path = here("output"), device = "jpg")
ggsave("Cod_stock_10.jpg", plot = Cod_Stock,
path = here("output"), device = "jpg")
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_20, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Pollock Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Pollock_len <- stomach_contents_2021 %>%
filter(Pred_common == "Walleye pollock", stock_arrowtooth != "empty") %>%
group_by(Len_bin_20, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Cod_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod", stock_arrowtooth != "empty") %>%
group_by(Len_bin_20, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_20, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Pollock Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Cod_Stock <- ggplot(Cod_len, aes(x = Len_bin_20, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Cod Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Pollock_Stock
Cod_Stock
ggsave("Pollock_stock_20.jpg", plot = Pollock_Stock,
path = here("output"), device = "jpg")
ggsave("Cod_stock_20.jpg", plot = Cod_Stock,
path = here("output"), device = "jpg")
View(raw_diet_table)
range(raw_stomach_contents2021$START_DATE)
range(raw_stomach_contents2021$Month)
#Load libraries
library(readr)
library(tidyverse)
library(here)
#load data
raw_stomach_contents2021 <- read_csv(here("data/GOA_Raw_StomachContents2021.csv"))
groupings <- read_csv(here("output/groupings.csv"))
#Joining stomach contents with prey groupings
#methods: groupings was done manually. clean names are all taxonomic classifications
sc_groupings <- left_join(raw_stomach_contents2021,groupings,by="Prey_Name")
#creating sample size table
#Create length bins
stomach_contents_2021 <- sc_groupings %>%
mutate(uniqueID = paste(HAULJOIN, PRED_NODC, PRED_SPECN,  sep = "_"),
Len_bin_20 = cut(PRED_LEN, breaks = c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200,
220, 240, 260, 280)),
Len_bin_10 = cut(PRED_LEN, breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110,
120, 130, 140, 150, 160, 170, 180, 190, 200, 210,
220, 230, 240, 250, 260, 270, 280)))
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_grouping != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Halibut_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific halibut", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Pollock_len <- stomach_contents_2021 %>%
filter(Pred_common == "Walleye pollock", stock_groupings != "empty") %>%
group_by(Len_bin_20, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Cod_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod", stock_groupings != "empty") %>%
group_by(Len_bin_20, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Plotting
colorlist<-c('#e6194b', '#ffe119', '#bcf60c', '#3cb44b', '#46f0f0', #'#f58231',
'#4363d8', '#911eb4', '#f032e6', '#800000', '#9A6324',
'#ffd8b1', '#808000', '#fffac8', '#000075', '#008080',
'#aaffc3', '#e6beff', '#a9a9a9', '#fabebe')
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_10, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Pollock_Stock <- ggplot(Pollock_len, aes(x = Len_bin_20, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Pollock Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Cod_Stock <- ggplot(Cod_len, aes(x = Len_bin_20, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Cod Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Halibut_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific halibut", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Pollock_len <- stomach_contents_2021 %>%
filter(Pred_common == "Walleye pollock", stock_groupings != "empty") %>%
group_by(Len_bin_20, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Cod_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific cod", stock_groupings != "empty") %>%
group_by(Len_bin_20, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
ggsave("Arrow_stock_10.jpg", plot = Arrow_Stock,
path = here("output"), device = "jpg")
#load data
raw_stomach_contents2021 <- read_csv(here("data/GOA_Raw_StomachContents2021.csv"))
groupings <- read_csv(here("output/groupings.csv"))
#Joining stomach contents with prey groupings
#methods: groupings was done manually. clean names are all taxonomic classifications
sc_groupings <- left_join(raw_stomach_contents2021,groupings,by="Prey_Name")
#creating sample size table
#Create length bins
stomach_contents_2021 <- sc_groupings %>%
mutate(uniqueID = paste(HAULJOIN, PRED_NODC, PRED_SPECN,  sep = "_"),
Len_bin_20 = cut(PRED_LEN, breaks = c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200,
220, 240, 260, 280)),
Len_bin_10 = cut(PRED_LEN, breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110,
120, 130, 140, 150, 160, 170, 180, 190, 200, 210,
220, 230, 240, 250, 260, 270, 280)))
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#load data
raw_stomach_contents2021 <- read_csv(here("data/GOA_Raw_StomachContents2021.csv"))
groupings <- read_csv(here("output/groupings.csv"))
#Joining stomach contents with prey groupings
#methods: groupings was done manually. clean names are all taxonomic classifications
sc_groupings <- left_join(raw_stomach_contents2021,groupings,by="Prey_Name")
#creating sample size table
#Create length bins
stomach_contents_2021 <- sc_groupings %>%
mutate(uniqueID = paste(HAULJOIN, PRED_NODC, PRED_SPECN,  sep = "_"),
Len_bin_20 = cut(PRED_LEN, breaks = c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200,
220, 240, 260, 280)),
Len_bin_10 = cut(PRED_LEN, breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110,
120, 130, 140, 150, 160, 170, 180, 190, 200, 210,
220, 230, 240, 250, 260, 270, 280)))
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Arrowtooth
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#Arrowtooth
Arrowtooth_len$stock_arrowtooth <- factor(Arrowtooth_len$stock_arrowtooth,
levels = c("arthropoda", "copepod", "euphausiids", "cod", "flatfish",
"walleye pollock", "target fish", "forage fish", "fish",
"other"))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#load data
raw_stomach_contents2021 <- read_csv(here("data/GOA_Raw_StomachContents2021.csv"))
groupings <- read_csv(here("output/groupings.csv"))
#Joining stomach contents with prey groupings
#methods: groupings was done manually. clean names are all taxonomic classifications
sc_groupings <- left_join(raw_stomach_contents2021,groupings,by="Prey_Name")
#creating sample size table
#Create length bins
stomach_contents_2021 <- sc_groupings %>%
mutate(uniqueID = paste(HAULJOIN, PRED_NODC, PRED_SPECN,  sep = "_"),
Len_bin_20 = cut(PRED_LEN, breaks = c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200,
220, 240, 260, 280)),
Len_bin_10 = cut(PRED_LEN, breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110,
120, 130, 140, 150, 160, 170, 180, 190, 200, 210,
220, 230, 240, 250, 260, 270, 280)))
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
#Arrowtooth
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Arrowtooth
Arrowtooth_len$stock_arrowtooth <- factor(Arrowtooth_len$stock_arrowtooth,
levels = c("arthropoda", "copepod", "euphausiids", "cod", "flatfish",
"walleye pollock", "target fish", "forage fish", "fish",
"other"))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#Arrowtooth
Arrowtooth_len$stock_arrowtooth <- factor(Arrowtooth_len$stock_arrowtooth,
levels = c("arthropoda", "euphausiids", "cod", "flatfish",
"walleye pollock", "target fish", "forage fish", "fish",
"other"))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
arrowcolor <- c('#e6194b', '#ffe119', '#d0d1e6','#a6bddb','#74a9cf','#3690c0',
'#0570b0','#034e7b', '#800000')
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
#save
ggsave("Arrow_stock_10.jpg", plot = Arrow_Stock,
path = here("output"), device = "jpg")
#Halibut
Halibut_len <- stomach_contents_2021 %>%
filter(Pred_common == "Pacific halibut", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#Halibut
Halibut_Stock <- ggplot(Halibut_len, aes(x = Len_bin_10, y = PW, fill = stock_groupings)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colorlist) +
labs(title = "Halibut Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Halibut_Stock
View(Halibut_len)
#Creating summary figures (using general stock prey grouping) which includes predator length
#recalculating PW including length bins
#Arrowtooth
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_groupings != "empty") %>%
group_by(Len_bin_10, stock_groupings) %>%
summarise(TotalWt = sum(PREY_TWT), n = length(unique(uniqueID)))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
View(Arrowtooth_len)
Arrowtooth_len_test <- Arrowtooth_len %>%
group_by(Len_bin_10) %>%
mutate(nsum = sum(n))
View(Arrowtooth_len_test)
Arrowtooth_len <- Arrowtooth_len %>%
group_by(Len_bin_10) %>%
mutate(nsum = sum(n))
View(Arrowtooth_len)
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
geom_text(data = distinct(Arrowtooth_len, Len_bin_10, nsum),
aes(x = Len_bin_10, y = 1.05, label = nsum)) +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#adding sample size to bar graph
Arrowtooth_len <- Arrowtooth_len %>%
group_by(Len_bin_10) %>%
mutate(nsum = sum(n))
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT), n = length(unique(uniqueID)))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#adding sample size to bar graph
Arrowtooth_len <- Arrowtooth_len %>%
group_by(Len_bin_10) %>%
mutate(nsum = sum(n))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
geom_text(data = distinct(Arrowtooth_len, Len_bin_10, nsum),
aes(x = Len_bin_10, y = 1.05, label = nsum)) +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
Arrowtooth_len <- stomach_contents_2021 %>%
filter(Pred_common == "Arrowtooth flounder", stock_arrowtooth != "empty") %>%
group_by(Len_bin_10, stock_arrowtooth) %>%
summarise(TotalWt = sum(PREY_TWT), n = length(unique(uniqueID)))  %>%
mutate(PW = (TotalWt/(sum(TotalWt))*100))
#adding sample size to bar graph
Arrowtooth_len <- Arrowtooth_len %>%
group_by(Len_bin_10) %>%
mutate(nsum = sum(n))
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
geom_text(data = distinct(Arrowtooth_len, Len_bin_10, nsum),
aes(x = Len_bin_10, y = 1.05, label = nsum)) +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
geom_text(data = distinct(Arrowtooth_len, Len_bin_10, nsum),
aes(x = Len_bin_10, y = 1.05, label = nsum)) +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity")
Arrow_Stock
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
geom_text(data = distinct(Arrowtooth_len, Len_bin_10, nsum),
aes(x = Len_bin_10, y = 1.05, label = nsum)) +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
Arrow_Stock <- ggplot(Arrowtooth_len, aes(x = Len_bin_10, y = PW, fill = stock_arrowtooth)) +
geom_bar(stat = "identity") +
geom_text(data = distinct(Arrowtooth_len, Len_bin_10, nsum),
aes(x = Len_bin_10, y = 1.05, label = nsum)) +
scale_fill_manual(values = arrowcolor) +
labs(title = "Arrowtooth Diet", y = "percent weight",
x = "predator length") +
theme_minimal()
Arrow_Stock
